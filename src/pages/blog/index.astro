---
import { getCollection } from 'astro:content';
import BlogPostList from '@/components/BlogPostList.astro';
import { BLOG_PAGE_SIZE, SITE_DESCRIPTION, SITE_TITLE } from '@/consts';
import BaseLayout from '@/layouts/BaseLayout.astro';

const allPosts = (await getCollection('blog'))
  .filter((post) => !post.data.hidden)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

const posts = allPosts.slice(0, BLOG_PAGE_SIZE);
const hasNextPage = allPosts.length > BLOG_PAGE_SIZE;
---

<BaseLayout title={SITE_TITLE} description={SITE_DESCRIPTION}>
	<main>
		<section>
			<h1 class="text-4xl font-bold mb-8 text-center scramble-text" data-original-text="Blog">Blog</h1>
			<BlogPostList posts={posts} />
			
			<!-- ページネーション -->
			{hasNextPage && (
				<nav class="flex justify-center items-center gap-4 mt-12" aria-label="ページネーション">
					<span class="text-gray-600 dark:text-gray-400">
						ページ 1 / {Math.ceil(allPosts.length / BLOG_PAGE_SIZE)}
					</span>
					
					<a
						href="/blog/2/"
						class="px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition duration-200 no-underline text-black dark:text-white"
					>
						次のページ →
					</a>
				</nav>
			)}
		</section>
	</main>
</BaseLayout>
