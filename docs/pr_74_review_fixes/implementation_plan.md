
# 実装計画書: PRレビュー対応 (パンくずリスト改善)

## 修正対象ファイル

### 1. `src/layouts/BaseLayout.astro`

#### 現状の問題点
- `buildBreadcrumbs`関数内で `segments.indexOf(segment)` を使用して `href` を再構築しているため、パス内に同一のセグメント名が含まれる場合（例: `/blog/category/blog` など）、正しい `href` が生成されない可能性がある。
- `items` 配列の初期化が、ホームページかどうかのチェックの前に行われており、ホームページの場合は無駄な処理となっている。

#### 修正方針
- `segments` の反復処理の中で `currentPath` を累積的に構築し、正確な `href` を生成するようにロジックを変更する。
- ホームページの判定（`pathname === '/'`）を関数の冒頭に移動し、早期リターンすることで無駄な初期化を防ぐ。

### 2. `src/components/Breadcrumb.astro`

#### 現状の問題点
- `nav > ol` 要素に `style="... max-width: 960px;"` がインラインで記述されているが、これはCSSクラスまたは `<style>` ブロックで管理すべきであり、レビュー指摘によると冗長である。
- ホームアイコンのSVGコードが2箇所（リンクあり・なし）に重複して記述されている。
- `isLast`（最後の要素）の場合の処理の中に `index === 0`（最初の要素）かどうかをチェックするロジックがあるが、これは成分が1つしかない場合（＝ホームのみ）にしか成立しない。しかし、ホームのみの場合はコンポーネント自体が表示されない（`!isHomePage`）ため、この分岐は到達不能コードである。

#### 修正方針
- `ol` 要素のインラインスタイルから `max-width` を削除する。
- ホームアイコンのSVG文字列を定数（例: `HOME_ICON_SVG`）として定義し、`set:html` またはコンポーネント内変数として利用する。
- 到達不能な `index === 0` の条件分岐とその中身を削除する。

## 手順
1. `src/layouts/BaseLayout.astro` の修正を行う。
2. `src/components/Breadcrumb.astro` の修正を行う。
3. ローカルサーバーを起動し、パンくずリストの生成と表示が正しいか、特に重複セグメントがある場合やホーム画面での挙動を確認する。
4. `task.md` と `walkthrough.md` を更新する。
